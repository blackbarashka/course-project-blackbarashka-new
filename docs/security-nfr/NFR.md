# Security Non-Functional Requirements для Reading List API

## Категория: Аутентификация и Авторизация (A&A)

| ID | Название | Описание | Метрика/Порог | Проверка | Компонент | Приоритет |
|----|----------|-----------|---------------|----------|-----------|-----------|
| NFR-001 | Защита от brute-force логинов | Блокировка учётной записи при множественных неуспешных попытках | ≥5 неуспешных логинов за 5 мин → блокировка на 10 мин | Мониторинг, тесты | Аутентификация | High |
| NFR-002 | Унификация ответов аутентификации | Ответы не раскрывают причину ошибки (пароль/логин неверен) | 100% унифицированных сообщений | Статический анализ | Аутентификация | High |

## Категория: Ограничение частоты и защита от автоматизации

| ID | Название | Описание | Метрика/Порог | Проверка | Компонент | Приоритет |
|----|----------|-----------|---------------|----------|-----------|-----------|
| NFR-003 | Rate limiting для создания книг | Ограничение частоты добавления новых книг | POST /api/v1/books ≤10 попыток/пользователь/мин | Нагрузочное тестирование | Books API | Medium |
| NFR-004 | Защита от автоматического сканирования | Ограничение общих запросов к API | ≤100 RPS на IP; при превышении → 429 + Retry-After | WAF, мониторинг | Весь API | High |

## Категория: Ошибки и ответы

| ID | Название | Описание | Метрика/Порог | Проверка | Компонент | Приоритет |
|----|----------|-----------|---------------|----------|-----------|-----------|
| NFR-005 | Безопасная обработка ошибок | Тела ошибок не раскрывают внутреннюю структуру | 100% унифицированных ошибок; нет stack trace | Тесты, сканирование | Все эндпоинты | High |
| NFR-006 | Маскирование чувствительных данных | Пользовательские данные маскируются в логах | 100% email/имен в логах маскируются | Аудит логов | Логирование | High |

## Категория: Секреты и конфигурации

| ID | Название | Описание | Метрика/Порог | Проверка | Компонент | Приоритет |
|----|----------|-----------|---------------|----------|-----------|-----------|
| NFR-007 | Управление секретами | Секреты только из хранилища, отсутствие в коде | 0 секретов в коде/логах; ротация ≤90 дней | Secret scanning | Конфигурация | High |
| NFR-008 | Безопасность зависимостей | Отсутствие уязвимостей в зависимостях | 0 Critical/High уязвимостей в зависимостях | SAST сканирование | Зависимости | High |

## Категория: Логи/аудит/трассируемость

| ID | Название | Описание | Метрика/Порог | Проверка | Компонент | Приоритет |
|----|----------|-----------|---------------|----------|-----------|-----------|
| NFR-009 | Аудит критичных операций | Логирование всех операций с книгами | ≥95% CRUD операций с correlation_id | Аудит логов | Весь сервис | Medium |
| NFR-010 | Приватность и ретеншн | Ограничение хранения пользовательских данных | Ретеншн логов ≤30 дней; маскирование ПДн | Политики хранения | База данных | Medium |
